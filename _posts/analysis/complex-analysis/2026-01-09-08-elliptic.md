---
layout: post
title: "Complex Analysis 椭圆函数"
permalink: /posts/complex-analysis-elliptic/
tags: complex-analysis
use\_math: true
---

本文系统研究椭圆函数理论。首先定义椭圆函数为双周期亚纯函数，证明不存在非常数的全纯椭圆函数，建立椭圆函数的次数理论。然后详细研究Weierstrass ℘-函数，证明它满足代数微分方程，并建立椭圆曲线与复环面的双全纯同构。接着讨论椭圆函数域的结构，证明每个椭圆函数都可以表示为℘和℘'的有理函数。最后引入Abel定理和θ函数，研究椭圆积分，并讨论模函数λ在单值化中的作用。

## 椭圆函数

设 $\Gamma = ℤ \omega\_1 + ℤ \omega\_2$ 是一个格 (lattice),其中 $\omega\_1, \omega\_2$ 线性无关。我们考虑亚纯函数 (meromorphic functions) $f:\mathbb{C} \to \hat{\mathbb{C}}$,其具有性质:$f$ 在 (加上 $\Gamma$ 的元素) 下不变,即 $\forall z\in \mathbb{C}, \forall \omega\in \Gamma, f(z+\omega) = f(z)$。

这样的函数称为椭圆函数 (elliptic functions) 或关于格 $\Gamma$ 的椭圆函数。

椭圆函数的集合是一个域 (通过逐点乘法和加法)

证明与 $\hat{\mathbb{C}}$ 的情况相同.

如果 $f(z+\omega\_1) = f(z), f(z+\omega\_2) = f(z), \forall z\in \mathbb{C}$, 那么 $f$ 是椭圆函数。

设 $f:\mathbb{C} \to \mathbb{C}$ 是全纯的椭圆函数. 则 $f$ 是常数。

考虑 $T := \{s\omega\_1 + t\omega\_2 \| s,t \in [0,1)\}$. 则 $\bar{T} = \{s \omega\_1 + t\omega\_2 \| s,t \in [0,1]\}\subset \mathbb{C}$ 是紧致的,且 $T$ 是 $\Gamma$ 在 $\mathbb{C}$ 上加法群作用的基本域,即 $\forall z\in \mathbb{C}, \exists ! \omega \in \Gamma$ 使得 $z-\omega \in T$.

函数 $f$ 在 $\bar{T}$ 上有界 (因为 $\bar{T}$ 是紧致的) 由于 $T\subset \bar{T}$ 是基本域, $f$ 在 $\mathbb{C}$ 上有界. 由Liouville定理, $f$ 在 $\mathbb{C}$ 上是常数.

椭圆曲线 (作为曲面)

$\mathbb{R}$, $ℤ$ 在 $\mathbb{R}$ 上作用, 我们研究 $S^1 = \mathbb{R} / ℤ$ 上的函数.

我们考虑空间 $\mathbb{C} / \Gamma = \mathbb{C} / \sim$,其中 $z \sim \tilde{z}$ 当且仅当 $z-\tilde{z} \in \Gamma$。

观察: 如果 $f:\mathbb{C}  \to \mathbb{C}$ 是 $\Gamma$-不变的,则它通过 $\underline{f}([z]) = f(z)$ 诱导出函数 $f: \mathbb{C} / \Gamma \to \mathbb{C}, M, \hat{\mathbb{C}}$.

$\mathbb{C} / \sim$ 关于商拓扑是紧致的拓扑空间,如果 $f:\mathbb{C} \to M$ 是连续的且 $\Gamma$-不变的,则 $\underline{f}:\mathbb{C} / \sim \to M$ 也是连续的.

$\pi:\mathbb{C} \to \mathbb{C} / \Gamma$ 是一个(拓扑)覆盖。

如果 $f:= \underline{f} \circ \pi : \mathbb{C} \to \hat{C}$ 是亚纯的,则称 $f:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 是亚纯的.

这样的 $f$ 是椭圆函数,且每个椭圆函数都由唯一的 $f:\mathbb{C} / \Gamma \to \mathbb{C}$ 给出.

设 $f:\mathbb{C} \to \hat{\mathbb{C}}$ 是椭圆函数. 则 $\\operatorname{ord}\_z f = \\operatorname{ord}\_{z+\omega} f$, $\forall z\in \mathbb{C} , \omega \in \Gamma$ 且 $\\operatorname{res}\_z f = \\operatorname{res}\_{z+\omega} f$.

从 $f(z+\omega) = f(z)$ 可得在 $z\_0$ 和 $z\_0 + \omega$ 处的Laurent展开 $$f(z\_0 + z) = \sum\_{n=0}^\infty a\_n z^n = f(z\_0 + z+ \omega)$$

对于 $f:\mathbb{C} \to \hat{\mathbb{C}}$,我们定义在点 $p=[z]$ 处的阶和留数如下: $\\operatorname{ord}\_{[z]}\underline{f} = \\operatorname{ord}\_z (\underline{f}\circ c)$ 和 $\\operatorname{res}\_{[z]}\underline{f} = \\operatorname{res}\_z (\underline{f}\circ c)$,由于上述引理,这是良定义的.

设 $\underline{f}:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 是亚纯的. 则 $$\sum\_{[z] \in \mathbb{C} / \Gamma} \\operatorname{res}\_{[z]} \underline{f} = 0.$$ (且只有有限多个极点)

我们对函数 $\underline{f} \circ \pi = f$ 应用"经典"留数定理.

断言: 存在 $z\_0 \in \mathbb{C}$ 使得 $z\_0 + \partial T = \{z\_0 + s\omega\_1 \| s\in [0,1]\}
    \cup \{z\_0 +\omega\_1 + t\omega\_2 \| t\in [0,1]\}
    \cup \{z\_0 + \omega\_2 + s\omega\_1 \| s\in [0,1]\}
    \cup \{z\_0 + t \omega\_2 \| t\in [0,1]\}$

不包含 $f$ 的任何极点.

事实上,由于 $\bar{T}$ 是紧致的且极点不能聚积,$\bar{T}$ 中极点的个数是有限的.

因此关于 $z\_0$ 存在的断言是显然的,否则我们会有无穷多个极点.

取 $\gamma: [0,1] \to \mathbb{C}$ 使得

不存在只有一个一阶极点的椭圆函数。

设 $f:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 是非常数椭圆函数. 则 $a\in \mathbb{C}$ 在 $f$ 下的原像数(计入重数)等于 $f$ 的极点数(计入重数).

观察到如果 $f$ 不是常数,则 $\\operatorname{Im}(f) = \hat{\mathbb{C}}$.

事实上,$f$ 的像必须是开的. 因为 $f$ 是非常数全纯函数.

像也是闭的,因为它是紧致域在连续函数下的像,而 $\hat{\mathbb{C}}$ 是连通的,所以 $f(\mathbb{C}/ \Gamma)= \hat{\mathbb{C}}$.

因此对于某个 $a\in \mathbb{C} \subset \hat{\mathbb{C}}$,存在 $b\in \mathbb{C} / \Gamma$ 使得 $f(b)= a$,考虑椭圆函数 $g= f-f(b)$. 像之前一样,我们可以平移基本域 $\bar{\Gamma}$ 使得其边界上不包含零点或极点,对椭圆函数 $\frac{g'}{g}$ 应用留数定理得到

$$\begin{aligned}
            0 &= \sum\_p \\operatorname{res}\_p \frac{g'}{g}  \\
            &= \sum\_{p\text{ 是 } g \text{ 的零点}} \\operatorname{ord}\_p g - \sum\_{p\text{ 是 } g \text{ 的极点}} (-\\operatorname{ord} g)\\
            &= \sharp \text{ 的 } a \text{ 的原像} - f \text{ 的极点数} \\
        \end{aligned}$$

对于 $f:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 非常数函数,极点的个数(计入重数)称为 $f$ 的**次数** (degree).

不存在次数为 $1$ 的椭圆函数。

根据次数定理,不存在非常数全纯椭圆函数.

假设 $f:\mathbb{C} /\Gamma \to \hat{\mathbb{C}}$ 的次数为 $1$.

断言: 这个映射将是同胚.

根据次数定理,$f$ 将是双射. $f$ 是连续且开的,因此是同胚.

看常数函数 $f=1$.

如果 $\mathbb{C} / \Gamma \cong \hat{\mathbb{C}}$,则 $f$ 将有原函数 $F:\mathbb{C} / \Gamma \to \mathbb{C}$,它是全纯且非常数的.

是否存在次数为 $2$ 的椭圆函数? 存在。

Weierstrass $\wp$-函数是次数为 $2$ 的椭圆函数,在 $[z] = 0\in \mathbb{C} / \Gamma$ 处有二阶极点. $\wp$ 是偶函数 $\wp(z) = \wp(-z)$.

像 $\frac{1}{\wp-a}$ 这样的映射次数为 $2$,对于一般的 $a\in \mathbb{C}$ 有两个单极点.

我们需要证明对于 $\omega\in \Gamma$ 和 $z\in \mathbb{C}$.

$$\wp(z+\omega) = \wp(z).$$

注意到根据级数,$\wp(z) = \wp(-z)$.

$$\wp'(z) = -2\sum\_{\gamma\in \Gamma} \frac{1}{(z-\gamma)^3}$$

通过同样的求和技巧,对于所有 $\omega\in M$ 和 $z\in \mathbb{C}$, $$\wp'(z+\omega) = \wp'(z)$$

因此对于所有 $\omega\in \Gamma$,函数 $\wp(z+\omega) - \wp(z)$ 是常数,因为其导数为零.

取 $z = -\frac{\omega}{2}$,得到 $c\_\omega = \wp(\frac{\omega}{2}) - \wp(-\frac{\omega}{2}) = 0$ $\implies$ $\wp$ 是椭圆函数.

$\wp':\mathbb{C}/\Gamma \to \hat{\mathbb{C}}$ 是次数为 $3$ 的椭圆函数. 其零点在 $\frac{\omega\_1}{2}$, $\frac{\omega\_1+\omega\_2}{2}$, $\frac{\omega\_2}{2}$,其中 $\Gamma = ℤ \omega\_1 + ℤ \omega\_2$. $\wp'$ 是奇函数 $\wp'(z) = -\wp'(-z)$.

通过同样的求和技巧或因为 $\wp$ 是偶函数,$\wp'$ 是奇函数.

$\wp'$ 恰好有一个三阶极点,没有其他极点. 所以次数是 $3$,且 $\wp'$ 必须有 $3$ 个零点.

我们有 $\wp'(\frac{\omega}{2}) = \wp'(-\frac{\omega}{2}), \forall \omega\in \Gamma$,这表明 $\wp'(\frac{\omega\_1}{2}) = 0 = \wp'(\frac{\omega\_2}{2})$

值 $e\_1 = \wp(\frac{\omega\_1}{2}), e\_2 = \wp(\frac{\omega\_1+\omega\_2}{2}), e\_3 = \wp(\frac{\omega\_2}{2})$ 互不相同.

每个值有两个原像,计入重数. 但由于 $\wp'(\frac{\gamma}{2}) = 0$,重数恰好是 $2$.

$\wp$ 满足复常微分方程.

$\wp'^2 = 4 \wp^3 - g\_2 \wp - g\_3$,其中 $g\_2, g\_3\in \mathbb{C}$,即 $$g\_2 = 60 \sum\_{\gamma\in \Gamma\setminus\{0\}} \frac{1}{\gamma^4}.$$ $$g\_4 = 140 \sum\_{\gamma\in \Gamma \setminus \{0\}} \frac{1}{\gamma^6}.$$

我们考虑椭圆函数 $f:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$,其中 $f=\wp'^2 - 4\wp^3 - g\_2\wp - g\_3$,并研究它的极点. 它们恰好在格点处. 极点的阶最多为 $6$,但通过选择因子 $5$ 以及 $\wp(t) = \frac{1}{z^2} + \cdots$ 和 $\wp'(z) = -\frac{2}{z^3}+\cdots$,极点的阶最多为 $5$.

函数 $f$ 是偶函数(因为 $\wp, \wp'^2$ 是偶函数),所以极点的阶最多为 $4$. 但实际上我们有 $\wp(z) = \frac{1}{z^2}+a\_2 z^2 + a\_4 z^4$,其中 $a\_2 = 3 g\_2$ 且 $a\_4 = 5 g\_4$,因为对于 $\forall \gamma\in \Gamma/\{0\}$,我们有 $\frac{1}{(z-\gamma)^2} - \frac{1}{\gamma^2} - \sum\_{k\ge 1} \frac{k+1}{\gamma^{k+2}} z^k$.

特别地,四阶极点不出现,类似地,Laurent 展开中 $z^{-2}$ 和 $z^2$ 项的系数也消失了.

$e\_1 + e\_2 + e\_3 = 0$ 且 $g\_2 = -4(e\_1 e\_2 + e\_2 e\_3 + e\_1 e\_3)$, $g\_4 = 4e\_1e\_2e\_3$,其中 $e\_1 = \wp(\frac{\omega\_1}{2}), e\_2 = \wp(\frac{\omega\_1+\omega\_2}{2}), e\_3 = \wp(\frac{\omega\_2}{2})$.

$$\wp'^2 = 4(\wp-e\_1)(\wp-e\_2)(\wp-e\_3)$$

$$2\wp'' = 12 \wp^2 - g\_2$$ $$\wp'''(z) = 12\wp(z) \wp'(z)$$

## 椭圆曲线

我们考虑集合 $$X = \{(y,z)\in \mathbb{C}^2\| y^2 = 4(x-e\_1)(x-e\_2)(x-e\_3)\}$$ 其中 $e\_1\ne e\_2, e\_2\ne e\_3, e\_1\ne e\_3$.

通过变量变换 $x\mapsto x+a$ ($a= \frac{1}{3}(f\_1+f\_2+f\_3)$),我们可以不失一般性地假设 $e\_1+e\_2+e\_3=0$。

$X\subset \mathbb{C}^2$ 是一个连通子集,可以通过添加一个点 $\infty$ 来紧化. 令 $x = \frac{1}{w}$,则 $$y^2  = 4(\frac{1}{w}-e\_1) (\frac{1}{w}-e\_2) (\frac{1}{w}-e\_3) \implies (y^2 \cdot w^2) = 4\cdot w (1-e\_1 w)(1-e\_2 w)(1-e\_3 w)$$ 记 $\tilde{y} = yw^2$,则 $y = \frac{\tilde{y}}{w^2}$,我们看到对于 $w=0 \iff x=\infty$,恰好有一个解 $\tilde{y}=0$.

这样 $\hat{X} = X\cup \{\infty\}$ 是一个拓扑空间,具有全纯坐标 $y,z,\tilde{y}$. 它被称为椭圆曲线.

设 $\Gamma \subset \mathbb{C}$ 是一个(余紧)格,$\wp$ 是其 Weierstrass $\wp$-函数. 则映射 $$F:\mathbb{C}/ \Gamma \to \hat{X} = \{(y,x)\|y^2 = 4(x-e\_1)(x-e\_2)(x-e\_3) \}\cup \{\infty\},$$ 其中 $e\_1 = \wp(\frac{\omega\_1}{2}), e\_2 = \wp(\frac{\omega\_1+\omega\_2}{2}), e\_3 = \wp(\frac{\omega\_2}{2}), F = (\wp', \wp)$ 是同胚,且在 $\hat{X}$ 的坐标 $y,x,\tilde{y}$ 下是全纯的.

$F$ 是良定义的,因为 $\wp$ 满足对应的常微分方程.

$F$ 是双射. 第二个分量 $\wp$ 取每个值 $x\in \mathbb{C} \cup \{\infty\}$ 两次(计入重数),对于 $x\ne x\_1,x\_2,x\_3$,第一个分量 $\wp'$ 在两个对应的原像处符号不同. 因此 $F$ 是满射和单射.

可以证明 $U\subset \hat{X}$ 是开的当且仅当 $x(U), y(U), \tilde{y}(U)$ 在其定义域的交集上的限制是开的.

在坐标 $x,y,\tilde{y}$ 下,映射 $F$ 看起来像 $$\begin{aligned}
        x\circ F = \wp  \\
        y \circ F = \wp' \\
        \tilde{y} \circ F = \frac{\wp'}{\wp^2}
    \end{aligned}$$

这三个都是局部同胚(在 $x,y,\tilde{y}$ 是坐标的原像集上)

我们是否得到所有这样的椭圆曲线?

我们是否总能找到对应于椭圆曲线的格?

答案是肯定的.

## 椭圆函数域: μ(\mathbb{C}/Γ)

椭圆函数的空间是一个域。

我们想理解域 $\mu(\mathbb{C} / \Gamma)$ 的结构。

$$\mu(\mathbb{C} / \Gamma) = \mathbb{C} (\wp)[\wp']/(\wp'^2 - 4(\wp-e\_1)(\wp-e\_2)(\wp-e\_3))$$

即,每个椭圆函数 $f:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 都可以唯一地写成 $f=p(\wp)+ \wp' q(\wp)$,其中 $p,q :\hat{\mathbb{C}} \to \hat{\mathbb{C}}$ 是有理函数.

设 $f:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 是偶椭圆函数,使得所有极点都包含在格 $\Gamma$ 中. 则 $f=p\circ\wp$,其中 $p$ 是次数为 $\frac{\deg f}{2}$ 的多项式.

对极点阶数进行归纳: 如果 $\\operatorname{ord}\_p f = 0$,则 $f=c$.

如果 $\\operatorname{ord}\_p f = -2n$,则 $f = a\frac{1}{z^{2n}}+\cdots$. 考虑 $f-az^n \circ \wp$,它的极点阶数小于 $-2n+2$.

如果 $f:\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 是偶椭圆函数,则存在有理函数 $q:\hat{\mathbb{C}} \to \hat{\mathbb{C}}$ 使得 $q\circ \wp = f$.

$f$ 在 $\mathbb{C}/ \Gamma$ 中有有限多个极点 $z\_1,\cdots,z\_n$,阶数为 $n\_1,\cdots, n\_n$. 考虑 $$g = f\prod\_{i}^n (\wp(z)-\wp(z\_i))^{-n\_i}$$ 则根据前一个引理,$g = p\circ \wp$,因为它的所有极点都在格中.

将 $f$ 写成 $f = f^+ + f^-$,其中 $f^\pm$ 分别是偶函数和奇函数.

则 $f^+ = a\circ \wp$,对于唯一的 $a\in \mathbb{C}(z)$,且 $\frac{f^-}{\wp'}$ 是偶函数,所以 $\frac{f^-}{\wp'} = b\circ \wp$,对于唯一的 $b\in \mathbb{C}(z)$.

$\wp'^2$ 是偶函数. 它可以写成 $\wp'^2 = 4\wp^3 - g\_2\wp - g\_4$.

设 $z,w,z+w,z-w\in \mathbb{C} \setminus \Gamma$. 则 $$\wp(-(z+w)) + \wp(z) + \wp(w) - \frac{1}{4}\left(\frac{\wp'(z)-\wp'(w)}{\wp(z)-\wp(w)}\right)^2 = 0$$,其中 $\wp$ 是余紧格 $\Gamma\subset \mathbb{C}$ 的 Weierstrass $\wp$-函数.

固定 $w$,则左边定义了一个椭圆函数. 它的极点只能在 $z=0$ 或 $z=\pm w$ 处. 直接检查可知在 $z=0$ 处没有极点. 利用在 $z= \pm w$ 处的级数展开,我们看到极点相互抵消. 因此这个函数是常数. 在 $z=0$ 处展开证明了恒等式.

## 加法定理的几何版本

$X\subset \mathbb{C}^2$. 我们考虑 $\mathbb{CP}^2 = \{l\subset \mathbb{C}^3\|l \text{是1维向量空间}\}$ 或等价地 $\mathbb{CP}^2 = \mathbb{C}^3\setminus\{0\} / \sim$,其中 $v\sim w \iff w = \lambda v, \lambda \in \mathbb{C} \setminus \{0\}$.

我们通过 $(z,w) \mapsto [z,w,1]$ 将 $\mathbb{C}^2 \subset \mathbb{CP}^2$ 嵌入.

补集 $\mathbb{CP}^2 \setminus \mathbb{C}^2$ 是 $\mathbb{CP}^1$: $l \in \mathbb{CP}^2 \setminus \mathbb{C}^2 \implies l = \mathbb{C} (z\_1,z\_2,z\_3)$ 且 $z\_3 = 0$ $\implies$ $l = \mathbb{C} (z\_1,z\_2,0) = \mathbb{C}(z\_1,z\_2) \in \mathbb{CP}^1$.

像 $\mathbb{CP}^1$ 一样,我们可以使用其他坐标来计算 $\mathbb{CP}^2 \setminus \mathbb{C}^2$ 附近,例如通过 $(\tilde{z},\tilde{w}) \mapsto [1,\tilde{z},\tilde{w}]$ 或 $(\hat{z},\hat{w}) \mapsto [\hat{z},1,\hat{w}]$,其中 $(1,\tilde{z},\tilde{w}) = \lambda(1,z,w) \implies \tilde{z} = \frac{w}{z}, \tilde{w} = \frac{1}{z}$.

对于 $X = \{y,z\|y^2 = 4(x-e\_1)(x-e\_2)(x-e\_3)\}$ 和 $\hat{X} = X \cup \{\infty\}$,我们有一个到 $\mathbb{CP}^2$ 的自然扩张. $[y,x,1] = [1,\frac{x}{y},\frac{1}{y}]$,且 $\frac{z}{y}$ 和 $\frac{1}{y}$ 在 $\infty$ 处是全纯的,即用 $\tilde{y} = \frac{y}{x^2}$ 表示,我们有 $\frac{x}{y} = \frac{x^3}{y^2} \tilde{y}$ 和 $\frac{z^3}{y^2} (\tilde{y})$ 全纯地扩张到 $\tilde{y} = 0$,且 $\frac{1}{y} = \frac{x^2}{y^2} \cdot \tilde{y}$,其中 $\frac{x^2}{y^2}(\tilde{y})$ 全纯地扩张到 $\tilde{y} = 0$.

对于 $\mathbb{C}/ \Gamma$,我们看到 $[\wp',\wp,1]$ 作为 $[1,0,0]$ 全纯地扩张到 $[\wp] = 0\in \mathbb{C} / \Gamma$.

一条**直线** $L\in \mathbb{CP}^2$ 由一个复二维向量空间 $\hat{L}\subset \mathbb{C}^3$ 给出,即集合 $$L = P\hat{L} =  \{[v]\|v\in \hat{L}\}$$

$\mathbb{CP}^1 = \mathbb{CP}^2 \setminus \mathbb{C}^2$ 由 $\hat{L} = \mathbb{C}^2\oplus \{0\} \subset \mathbb{C}^3$ 给出.

两条不同的直线 $l\_1 \ne l\_2 \subset \mathbb{CP}^2$ 恰好相交于 $1$ 个点,计入重数.

利用线性代数.

椭圆曲线 $\hat{X}\subset \mathbb{CP}^2$ 和直线 $L\subset \mathbb{CP}^2$ 恰好相交 $3$ 次.

$\hat{X} \ne L$,否则我们会得到一个次数为 $1$ 的全纯映射 $\hat{X} \to L \cong \mathbb{CP}^1$.

因此只有有限多个交点. 对于 $\hat{L} = \mathbb{C}^2 \oplus \{0\}$,交点的阶为 $3$,因为 $\frac{1}{y}$ 有一个三阶零点.

否则我们可以参数化 $\hat{l} = \{\lambda(y\_1,x\_1)+(y\_0,x\_0)\|\lambda\in \mathbb{CP}^1\}$,它与 $\hat{X}$ 在 $\infty$ 处相交当且仅当 $x\_1 = 0$.

这正是 $$\lambda \mapsto P(\lambda(y\_1,x\_1)+(y\_0,x\_0))$$ 的次数小于 $3$ 的情况,即 $2$,这完成了证明.

在 $\mathbb{CP}^2$ 中,任意两个不同的点 $p\ne q$ 确定唯一的直线 $l\_{pq} = \{q+t(p-q)\|t\in \mathbb{C}\}$,它通过 $p$ 和 $q$.

$X$ 和 $L$ 在仿射部分 $i(\mathbb{C}^2) \subset CP^2$ 中的交点个数由多项式的零点个数给出.

$$\lambda\in \mathbb{C} \mapsto p(\lambda)$$

通过任意两个不同的点 $p\ne q \in \mathbb{CP}^2$,恰好有 $1$ 条直线 $L$,使得 $p,q\in L$.

唯一性: 两条直线只能相交于 $1$ 个点.

存在性: 设 $p=[v], q = [w]$. 则 $v,w$ 线性无关并张成复平面 $\hat{L} = \\operatorname{span}(v,w)\subset\mathbb{C}^2$,对应于一条直线 $L$,使得 $p,q\in L$.

设 $\Gamma \subset \mathbb{C}$ 是一个格,$\wp,\wp':\mathbb{C} / \Gamma \to \hat{\mathbb{C}}$ 是 Weierstrass $\wp$-函数及其导数.

设 $\hat{X} = \\operatorname{Im}([\wp',\wp,1])(\mathbb{C} / \Gamma) \subset CP^2$ 是对应的椭圆曲线,记 $F:=[\wp',\wp,1]$.

则,对于 $p,q \in \mathbb{C} / \Gamma$,存在唯一的直线 $L\in CP^2$ 使得 $F(p), F(q) \in L$. $\hat{X}$ 和 $L$ 的第三个交点由 $F(-(p+q))$ 给出.

加法是在 $\mathbb{C}/ \Gamma$ (一个阿贝尔群) 中进行的.

这给出了在每条椭圆曲线上定义阿贝尔群结构的一种几何方式.

## Abel 定理

**除子** (divisor) $D$ 是 $\mathbb{C}/ \Gamma$ 中点的以整数为系数的形式和.

$$D = \sum\_{j=1}^n n\_j p\_j$$

其中 $n\_j \in ℤ, p\_j \in \mathbb{C} / \Gamma$.

$\mathcal{A}: \text{ 除子集合 } \to \mathbb{C} / \Gamma$ 定义为 $\mathcal{A} (\sum n\_j p\_j) = \sum\_j n\_j p\_j$,其中右边是阿贝尔群 $\mathbb{C} / \Gamma$ 中的运算.

对于椭圆函数 $f:\mathbb{C}/ \Gamma \to \hat{\mathbb{C}}$,我们定义 $(f) = D=\sum\_{p\in \mathbb{C}/ \Gamma} \\operatorname{ord}\_p f\cdot p$. (这个和实际上是有限的)

除子的次数定义为 $\deg(\sum\_j n\_j p\_j) = \sum\_j n\_j$。

对于 $f:\mathbb{C} /\Gamma \to \hat{\mathbb{C}}$,$\deg(f)\ne \deg((f))$,除非 $f$ 是常数. 事实上,根据 Cauchy 定理,$\deg((f)) = 0$.

除子 $D = \sum\_j n\_j p\_j$ 是某个椭圆函数 $f:\mathbb{C} /  \Gamma \to \hat{\mathbb{C}}$ 的除子,$(f) = D$ $\iff$ $\deg(D) = 0$ 且 $\mathcal{A}(D) = 0 \in \mathbb{C} /\Gamma$.

$(\wp) = -2[0] + p\_1 + p\_2$,其中 $[0] \in \mathbb{C}/ \Gamma$,$p\_1 = [z] \in \mathbb{C}/\Gamma, z\in \mathbb{C}$,$p\_2 = [-z]\in \mathbb{C}/\Gamma$.

$\mathcal{A}((\wp)) = [-2\cdot 0+z-z] = [0] \in \mathbb{C}/ \Gamma$.

$\deg(D) = 0$ 通过计数显然成立.

设 $T\subset \mathbb{C}$ 是一个(平移的)基本域,使得在 $\partial T$ 上没有 $f$ 的极点或零点.

设 $(f) = p\_1 + \cdots + p\_n + q\_1+\cdots+q\_n$,其中点可以多次出现.

考虑亚纯函数 $h=z\cdot \frac{f'}{f}:\mathbb{C} \to \hat{C}$,它在 $\partial T$ 上没有任何极点.

此外,我们有 $$\\operatorname{res}\_p h = (\\operatorname{ord}\_p f)\cdot p$$

因此 $$\frac{1}{2\pi i} \int\_{\partial T} h = \sum\_{p\in \bar{T}} \\operatorname{ord}\_p f \cdot p = [\mathcal{A}((f))]$$

对于积分,我们观察到 $$h(a+t\omega\_1+\omega\_2) = \omega\_2 \frac{f'}{f}(a+t\omega\_1) + h(a+t\omega\_1)$$ 对于 $\omega\_1 \leftrightarrow \omega\_2$ 类似,即对于 $\gamma\_2$ 和 $\gamma\_4$ ($\partial T = \gamma\_1\cup \gamma\_2\cup \gamma\_3\cup \gamma\_4$)

注意到 $\frac{f'}{f} = (\log f)'$,因为 $f$ 沿闭曲线是良定义的,我们有 $\frac{1}{2\pi i} \int\_{\gamma\_k} \frac{f'}{f} dz \in ℤ$,$k=1,2,3,4$.

这给出 $\frac{1}{2\pi i} \int\_{\partial T} h dz = \sum\_{p\in \bar{T}} \\operatorname{ord}\_p f \cdot p \in \Gamma$.

其中我们在 $\mathbb{C}$ 中求和,或等价地 $\mathcal{A}(D) = 0$,其中我们在 $\mathbb{C}/\Gamma$ 中求和.

对于反向,我们需要特殊函数或更高级的技术.

我们使用 $\vartheta$-函数.

## Theta 函数

如果 $f:\mathbb{C}/\Gamma \to \hat{\mathbb{C}}$ 是椭圆函数且 $c \ne 0$,则 $f(\frac{z}{c}):\mathbb{C} /c \Gamma \to \hat{\mathbb{C}}$ 对于新格 $c \Gamma$ 是椭圆函数.

因此只需研究形如 $\Gamma = \Gamma\_\tau : = ℤ + \tau ℤ$ 的格,其中 $\tau \in ℍ$.

$$\vartheta(z) = \vartheta(z,\tau) = \sum\_{n=-\infty}^\infty \exp(\pi i(n^2 \tau + 2nz))$$

设 $\tau \in ℍ$, $\vartheta:\mathbb{C} \to \mathbb{C}$ 是全纯的,即级数局部一致收敛.

直接计算.

$\vartheta$ 是整函数(且不是常数),所以它不是椭圆函数.

$\tau \in ℍ$. 对于所有 $z\in \mathbb{C}$, $\vartheta(z+1) = \vartheta(z)$, $\vartheta(z+\tau) = \vartheta(z) \cdot e^{-\pi i (\tau + 2z)}$.

$\tau \in ℍ$. $\vartheta$ 函数在基本域 $T$ 中恰好有 $1$ 个零点. 它位于 $\frac{1+\tau}{2}$.

$$[\vartheta] = 1\cdot [\frac{1+\tau}{2}]$$

在 $T$ 或 $\bar{T}$ 上,$\vartheta$ 只有有限多个零点. 平移后我们可以假设所有零点都包含在 $a+T$ 的内部.

因此我们可以通过 $$\frac{1}{2\pi i} \int\_{a+\partial T} \frac{\vartheta'(z)}{\vartheta(z)}dz.$$ 来计数.

我们有 $\frac{\vartheta'(z+1)}{\vartheta(z+1)} = \frac{\vartheta'(z)}{\vartheta(z)}$ 和 $\frac{\vartheta'(z+\tau)}{\vartheta(z+\tau)} = \frac{\vartheta'(z)}{\vartheta(z)} -2\pi i$.

因此 $$\frac{1}{2\pi i} \int\_{a+\partial T} \frac{\vartheta'}{\vartheta}dz = 1.$$

直接计算验证 $\frac{1+\tau}{2}$ 是一个零点.

设 $D = p\_1 +\cdots + p\_n + q\_1+\cdots+q\_n$ 是一个除子,满足 $\deg(D) = 0$ 且在 $\mathbb{C}/\Gamma$ 中 $\mathcal{A}(D) = 0$.

不失一般性,假设 $p\_1+\cdots +p\_n+q\_1+\cdots+q\_n = 0$.

考虑由 $$f(z) = \prod\_{j=1}^n \frac{\vartheta(z+\frac{1}{2}+\frac{\tau}{2}-p\_j)}{\vartheta(z+\frac{1}{2}+\frac{\tau}{2}-q\_j)}$$ 定义的 $f:\mathbb{C} \to \hat{\mathbb{C}}$

它在适当的点有零点和极点.

且满足 $f(z+1) = f(z)$ 和 $f(z+\tau) = f(z)$.

## 椭圆积分

如果 $p:\mathbb{C} \to \mathbb{C}$ 是 $3$ 次或 $4$ 次多项式,则

$$\int \frac{1}{\sqrt{p(z)}} dz$$ 称为椭圆积分.

椭圆: $\frac{x^2}{a^2} + \frac{y^2}{b^2} = 1$ 有参数化 $$x = a\cos(\theta)
    , y = b\sin(\theta)$$ 其中 $\theta$ 是参数.

因此它的长度是一个椭圆积分.

设 $p(x) = 4x^3 - g\_2 x -g\_3$ 由某个格 $\Gamma$ 诱导,即 $\wp'^2 = 4\wp^3 -g\_2 \wp -g\_3$.

则多值映射 $$x\mapsto -\int\_x^\infty \frac{dt}{\sqrt{p(t)}}$$ 以 Weierstrass $\wp$-函数为其逆函数,即 $$-\int\_{\wp(u)}^\infty \frac{dt}{\sqrt{p(t)}} = u$$

根据链式法则,我们利用一个常微分方程得到关于 $u$ 的导数相等,且为 $1$. 在 $u=0$ 处,左边也为零.

如果我们计算出椭圆积分,我们就可以计算出 Weierstrass $\wp$-函数.

设 $R$ 是一个矩形. 则 $\wp$-函数给出了到 $ℍ$ 的单值化 (uniformization).

## Weierstrass 函数作为单值化

设 $\Gamma = rℤ + siℤ$,其中 $r,s\in \mathbb{R}^{>0}$. 则 Weierstrass $\wp$-函数沿以下实直线是实的 $$[\mathbb{R}],[i\mathbb{R}],[i\mathbb{R}+\frac{r}{2}],[\mathbb{R}+\frac{is}{2}] \subset \mathbb{C}/\Gamma$$

我们利用 $\Gamma \subset (\mathbb{C},+)$ 在实对合 $\rho(z) = \bar{z}$, $\tau(z) = -\bar{z}$ 下的不变性,对于 $\wp:\mathbb{C} \to \hat{\mathbb{C}}$,我们考虑由 $f(z) = \overline{\wp(\rho(z))}, g(z) = \overline{\wp(\tau(z))}$ 定义的 $f,g:\mathbb{C} \to \hat{\mathbb{C}}$.

$f,g$ 是亚纯的,且关于 $\Gamma$ 是双周期的.

此外,$f,g$ 的极点是 $2$ 阶的,且恰好在格点处.

我们看展开 $\wp(z) = \frac{1}{z^2} + a\_2 z^2 + \cdots$,可以看出 $f,g$ 等于 $\wp$ 函数.

特别地,对于 $z\in \mathbb{R}$,我们有 $\overline{\wp(z)} = \overline{\wp(\rho(z))} = \wp(z)$,类似地对于 $z\in i\mathbb{R}$ 使用 $\tau$.

对于 $z\in \mathbb{R}+\frac{is}{2}$,我们有 $\overline{\wp(\rho(z))} = \wp(z) = \overline{\wp(z-is)} = \overline{\wp(z)}$.

类似地对于 $z\in i\mathbb{R} +\frac{r}{2}$.

矩形格 $\Gamma = rℤ + isℤ$ 的 $\wp$-函数给出了 $R = \{z\in \mathbb{C}\| \Re(z)\in (0,\frac{r}{2}), \Im(z) \in (0,\frac{s}{2})\}$ 的单值化,需要应用一个 Möbius 变换.

我们可以通过一个合适的 Möbius 变换来映射单位圆,使得矩形的任何点都不映射到 $\infty$.

这可以通过选择 Möbius 变换使得相邻矩形的一个点映射到 $\infty$ 来实现.

应用最大值原理得到我们的结果.

设 $p\in \mathbb{C}[x]$ 是一个 $3$ 次多项式,具有两两不同的零点. 则椭圆曲线 $X= \{(y,x)\| y^2 = p(x)\}$ 可以用某个格 $\Gamma$ 的椭圆函数来参数化.

第一步: 只需限制于形如 $p(x) = 4(x-e\_1)(x-e\_2)(x-e\_3)$ 的多项式,其中 $e\_i$ 两两不同且 $e\_1+e\_2+e\_3 = 0$. 一个简单的变量变换给出 $(\tilde{y},\tilde{x}) = (y,cx+b)$ 以及对应的椭圆函数.

类似地,我们可以做坐标变换使得 $e\_1=1,e\_3=0,e\_2 = m \in \mathbb{C}\setminus \{0,1\}$,并考虑 $(c\wp',\frac{\wp-\wp(\frac{\omega\_2}{2})}{\wp(\frac{\omega\_1}{2}) - \wp(\frac{\omega\_2}{2})})$,其中 $c^2 = \frac{1}{\wp(\frac{\omega\_1}{2})-\wp(\frac{\omega\_2}{2})}$.

注意到 $$m = \frac{\wp(\frac{\omega\_1+\omega\_2}{2})-\wp(\frac{\omega\_2}{2})}{\wp(\frac{\wp\_1}{2})-\wp(\frac{\wp\_2}{2})}$$ 因此,我们想证明对于每个 $m\in \mathbb{C}\setminus \{0,1\}$,存在 $\tau \in ℍ$ 使得 $$\lambda(\tau) := \frac{\wp\_\tau (\frac{1+\tau}{2})-\wp\_\tau (\frac{\tau}{2})}{\wp\_\tau (\frac{1}{2})-\wp\_\tau (\frac{\tau}{2})} = m$$ 我们被迫研究 $\lambda$-模函数的性质.

$\lambda$ 不依赖于格 $\Gamma \leftrightarrow c\Lambda$ 的缩放,只依赖于其生成元 $\omega\_1,\omega\_2$ 的标记.

注意到我们使用"非标准"约定 $e\_1 = \wp(\frac{\omega\_1}{2}), e\_2= \wp(\frac{\omega\_1+\omega\_2}{2}), e\_3 = \wp(\frac{\omega\_2}{2})$. 但 $\lambda$-函数是标准约定.

$\tau \mapsto \lambda(\tau)$ 是全纯的.

对于任意 $z\in \mathbb{C} \setminus ℤ$,$\tau \mapsto \wp\_\tau (z)$ 是全纯的.

考虑 $SL(2,ℤ) = \left\{\begin{pmatrix}
    a&b\\c&d
\end{pmatrix}\|a,b,c,d\in ℤ, ad-bc = 1\right\}$.

群 $SL(2,ℤ)$ 由矩阵 $$S = \begin{pmatrix}
        0&-1\\1&0
    \end{pmatrix}$$ 和 $$T = \begin{pmatrix}
        1&1\\0&1
    \end{pmatrix}$$ 生成.

我们考虑格 $\Gamma = \tau ℤ + 1ℤ$,和 $g = \begin{pmatrix}
    a&b\\c&d
\end{pmatrix}\in SL(2,ℤ)$.

则 $a\tau +b, c\tau +d$ 是同一个格的生成元. 事实上 $d(a\tau +b) - b(c\tau +d) = \tau$, $-c(a\tau +b) + a(c\tau +d) = 1$.

归一化后,我们得到等价的格 $\frac{a\tau+b}{c\tau+d} ℤ + 1ℤ$.

格 $\Gamma\_{\tau}$ 和 $\Gamma\_{\tilde{\tau}}$,其中 $\tau, \tilde{\tau} \in ℍ$,在共形意义下等价(即它们相差一个缩放)当且仅当 $\tilde{\tau} = \frac{a\tau +b}{c\tau +d}$,对于某个 $\begin{pmatrix}
        a&b\\c&d
    \end{pmatrix}\in SL(2,ℤ)$.

$\mathcal{M} = \{\tau \in ℍ \| \|\tau\|\ge 1, \Re(\tau) \in (-\frac{1}{2},\frac{1}{2}]\} \setminus \{e^{i\rho}\|\rho\in (\frac{\pi}{2},\frac{3\pi}{4})\}$ 是 $SL(2,ℤ)$ 在 $ℍ$ 上作用的基本域,即对于每个 $\tau \in ℍ$,存在唯一的 $g\in SL(2,ℤ)$ 使得 $g\cdot \tau \in \mathcal{M}$.

回顾 $\lambda:ℍ \to \mathbb{C} \setminus \{0,1\}$ 在 $SL(2,ℤ)$ 下不是不变的.

$\lambda$ 在一个 $SL(2,ℤ)$ 轨道下取以下 $6$ 个值: $$\lambda, \frac{1}{\lambda}, 1-\lambda, \frac{1}{1-\lambda}, \frac{\lambda}{\lambda-1}, \frac{\lambda-1}{\lambda}$$

记 $\wp(\frac{1}{2}) = e\_1, \wp(\frac{1+\tau}{2}) = e\_2, \wp(\frac{\tau}{2}) = e\_3$.

则 $\lambda = \frac{e\_2-e\_3}{e\_1-e\_3}$. 改变格生成元的标记给出 $3! = 6$ 种可能性,即这 $6$ 个值.

子群 $\Gamma\_{(2)} = \{g\in SL(2,ℤ) \| g = 1 \mod ℤ\_2\}$ 的指数是 $6$ 且使 $\lambda$ 不变.

$\lambda$ 沿 $[0,\infty)i \cup e^{i(0,\pi)} \cup 1+[0,\infty)i$ 是实值的.

根据矩形格 $\wp$-函数的性质,$\lambda$ 沿虚轴是实值的.

将其平移 $\pm 1$ 只改变 $\lambda \to \frac{\lambda}{\lambda-1}$,这保持实轴不变.

半圆是虚轴在 Möbius 变换 $ST^{-1}$ 下的像,它作用为 $\lambda \mapsto \frac{1}{1-\lambda}$.

$\lambda:ℍ \to \mathbb{C} \setminus \{0,1\}$ 是满射且局部单射. $\lambda(\tau) = \lambda(\tilde{\tau})$ 当且仅当 $\tilde{\tau} = g \tau$,对于某个 $g\in \Gamma\_{(2)} \subset SL(2,ℤ) \subset SL(2,\mathbb{R})$.

$\lambda$ 通过其局部逆映射在 $\mathbb{C} \setminus \{0,1\}$ 上诱导双曲度量.
